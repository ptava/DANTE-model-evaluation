#!/bin/sh
set -e
#------------------------------------------------------------------------------

#User-defined variables
NODES=1
PROC_PER_NODE=48
PARTITION="<partition_name>"
ACCOUNT="<account_name>"
TIME="24:00:00"
OF_MODULE="openfoam+/v2406"

# Flags for common mesh and dynamic code to avoid redundant computations
# Usefull only if we run each setup sequentially
COMMON_MESH=false
COMMON_DYNAMIC_CODE=false

# List of setups
setups=(
)

#------------------------------------------------------------------------------

# Loop through each setup to submit the jobs
for setup in "${setups[@]}"; do
    sbatch \
        --nodes="${NODES}" \
        --ntasks-per-node="${PROC_PER_NODE}" \
        --partition="${PARTITION}" \
        --account="${ACCOUNT}" \
        --time="${TIME}" \
        --hint=nomultithread \
        --job-name="OpenFOAM_${setup}" \
        --output="OpenFOAM_${setup}.out" \
        --error="OpenFOAM_${setup}.err" \
        --export=SETUP="${setup}",COMMON_MESH="${COMMON_MESH}",COMMON_DYNAMIC_CODE="${COMMON_DYNAMIC_CODE}",OF_MODULE="${OF_MODULE}" \
        submit_setup.sh
done

#------------------------------------------------------------------------------
